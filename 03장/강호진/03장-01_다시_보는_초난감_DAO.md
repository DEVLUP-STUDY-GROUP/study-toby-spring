# 3장 템플릿

## 3.0 들어가기

- 개방 폐쇄 원칙(OCP)
    - 코드에서 어떤 부분은 변경을 통해 그 기능이 다양해지고 확장하려는 성질이 존재
    - 코드에서 어떤 부분은 고정되어 있고 변하지 않으려는 성질이 존재
    - 변화의 특성이 다른 부분을 구분
        - 각자 다른 목적과 다른 이유에 의해 다른 시점에 독립적으로 변경될 수 있는 효율적인 구조를 만들어주는 것
- 템플릿
    - 템플릿은 바뀌는 성질이 다른 코드 중에서 변경이 거의 일어나지 않음
    - 일정한 패턴으로 유지되는 특성을 가진 부분을 자유롭게 변경되는 성질을 가진 부분으로 독립
        - 이를 통해 효과적으로 활용할 수 있도록 하는 방법

## 3.1 다시 보는 초난감 DAO

### 3.1.1 예외처리 기능을 갖춘 DAO

- DB 커넥션이라는 제한적인 리소스를 공유해 사용하는 서버에서 동작하는 JDBC 코드에는 반드시 지켜야할 원칙 → 예외처리
- 정상적인 JDBC 코드의 흐름을 따르지 않고, 중간에 예외가 발생했을 경우에도 사용한 리소스를 반드시 반환하도록 만들어야 함
- 일반적으로 서버에서는 제한된 개수의 DB 커넥션을 만들어서 재사용 가능한 풀로 관리
- 오류가 날때마다 미처 반환하지 못한 Connection 계속 쌓인 경우
    - 어느 순간 커넥션 풀에 여유가 없어지고 리소스가 모자란다는 심각한 오류를 내며 서버 중단 가능
- Connection과 PreparedStatement는 보통 풀(pool) 방식으로 운영
    - 미리 정해진 풀 안에 제한된 수의 리소스를 만들어두고 이를 할당하고, 반환하면 다시 풀에 넣는 방식으로 운영
    - close()는 보통 리소스를 반환한다는 의미로 이해
    - 요청이 매우 많은 서버 환경에서는 매번 새로운 리소스를 생성하는 대신 풀에 미릴 만들어둔 리소스를 돌려가며 사용하는 편이 유리
    - 사용한 리소스는 빠르게 반환해야 함, 그렇지 않으면 풀에 있는 리소스가 고갈되고 문제 발생
- 예외상황에 대한 처리를 모두 마침
    - 서버 환경에서도 안정적으로 주행될수 있으면서 DB 연결기능을 자유롭게 확장할 수 있는 이상적인 DAO이지만 아쉬움 