# 2장 테스트

## 2.0 들어가기

- **스프링이 개발자에게 제공하는 가장 중요한 가치는 객체지향과 테스트**
- 스프링의 핵심인 IoC와 DI는 오브젝트의 설계와 생성, 관계, 사용에 관한 기술
    - IoC/DI를 이용해 객체지향 프로그래밍 언어의 근본과 가치를 개발자가 손쉽게 적용하고 사용할 수 있게 도와주는 기술
    - 복잡한 엔터프라이즈 애플리케이션을 효과적으로 개발하기 위한 기술 → 필요한 도구: 객체지향 기술, 테스트
- 애플리케이션은 계속 변하고 복잡해지는데, 그 변화에 대응하는 전략
    - 확장과 변화를 고려한 객체지향적 설계, 그것을 효과적으로 담아낼 수 있는 IoC/DI 기술
    - 만들어진 코드를 확신할 수 있게 해주고, 변화에 유연하게 대처할 수 있는 자신감을 주는 테스트 기술
- 스프링으로 개발하면서 테스트를 만들지 않는다면 스프링이 지닌 가치의 절반을 포기하는 셈
- 테스트는 스프링을 학습하는데 가장 효과적인 방법 중 하나
- 테스트의 작성은 스프링의 다양한 기술을 활용하는 방법을 이해하고 검증하고, 실전에 적용하는 방법을 익히는 데 효과적으로 사용

## 2.1 UserDaoTest 다시보기

### 2.1.1 테스트의 유용성

- 만든 코드는 어떤 방법으로든 테스트해야 함
- 코드를 개선해나가는 과정에서 테스트란 내가 예상하고 의도했던 대로 코드가 정확히 동작하는지 확인해서 만든 코드를 확실할 수 있게 해주는 작업
- 테스트의 결과가 원하는 대로 나오지 않는 경우, 코드나 설계의 결함이 있음을 알 수 있음
    - 코드의 결함을 제거해가는 작업(디버깅)을 거치고, 테스트가 성공하면 결함이 제거되었다는 확신을 얻을 수 있음

### 2.1.2 UserDaoTest의 특징

- 웹 화면을 통해 값을 입력하고, 기능을 수행하고, 결과를 확인하는 방법은 가장 흔히 쓰이는 방법이지만, DAO에 대한 테스트로서는 단점이 너무 많음
    - DAO뿐만 아니라 서비스 클래스, 컨트롤러, 뷰 등 모든 레이어의 기능을 다 만들고 나서야 테스트가 가능하다는 점이 가장 큰 문제
    - 테스트 중에 에러가 나거나 테스트에 실패 시, 어디에서 문제가 말생했는지 찾아내야 하는 수고도 필요
    - 이유: 하나의 테스트를 수행하는 데 참여하는 클래스와 코드가 너무 많기 때문
- 테스트를 어떻게 만들면 이런 문제를 피하고, 효율적으로 테스트를 활용할 수 있는지 생각
    - 테스트하고자 하는 대상이 명확하다면 그 대상에만 집중해서 테스트하는 것이 바람직함
    - 한꺼번에 너무 많은 것을 몰아서 테스트 시, 테스트 수행 과정도 복잡해지고, 오류가 발생 시 정확한 원인을 찾기 힘들어짐
    - 테스트는 가능하면 작은 단위로 쪼개서 집중해서 할 수 있어야 함
    - 테스트의 관심이 다르다면 테스트할 대상을 분리하고 집중해서 접근 (관심사의 분리)
- 단위 테스트 (Unit Test): 작은 단위의 코드에 대해 테스트를 수행
    - 크기나 범위가 정해진 것은 아님, 하나의 관심에 집중해서 효율적으로 테스트할 만한 범위의 단위
    - 단위는 작을수록 좋음, 단위를 넘어서는 다른 코드들은 신경쓰지 않고 참여하지도 않고 테스트가 동작할 수 있으면 좋음
    - 통제할 수 없는 외부의 리소스에 의존하는 테스트는 단위 테스트가 아니라고 보기도 함
    - 필요한 이유: 개발자가 설계하고 만든 코드가 원래 의도한 대로 동작하는지를 개발자 스스로 빨리 확인받기 위해서
        - 확인의 대상과 조건이 간단하고 명확할수록 좋음, 작은 단위로 제한해서 테스트하는 것이 편리
    - 주로 개발자가 만든 코드를 스스로 확인하기 위해 사용하기 때문에 개발자 테스트(프로그래머 테스트)라고도 부름
    - 우리가 만들고 개선한 코드가 처음 설계하고 의도한 대로 바르게 동작했는지를 확인하기 위해 개발자 입장에서 만든 것
- 테스트는 자동으로 수행되도록 코드로 만들어지는 것이 중요 → 자주 반복할 수 있다는 장점
- 번거러운 작업이 없고 테스트를 빠르게 실행할 수 있기 때문에 언제든 코드를 수정하고 나서 테스트를 해볼 수 있음
- 때로는 단 한줄의 코드를 건드렸을 때 전체 기능에 영향을 주기도 함
- 만들어둔 기능에 대한 테스트가 있다면 수정 후 빠르게 전체 테스트를 수행해서 수정 때문에 다른 기능에 문제가 발생하지 않는지 확인
    - 성공한다면 마음에 확신을 얻을 수 있음
- 코드를 만들지 마자 바로 기능에 문제가 없는지 검증해주는 코드를 개선해나가는 작업을 진행할 수 있음
    - 수정에 실수가 있었다면 테스트를 통해 무엇이 잘못됐는지 바로 확인할 수 있음
- 테스트를 이용하면 새로운 기능도 기대한 대로 동작하는지 확인할 수 있음
    - 기존에 만들어뒀던 기능들이 새로운 기능을 추가하느라 수정한 코드에 영향을 받지 않고 잘 동작하는지를 확인할 수 있음

### 2.1.3 UserDaoTest의 문제점

- 수동 확인 작업의 번거러움
- 실행 작업의 번거러움