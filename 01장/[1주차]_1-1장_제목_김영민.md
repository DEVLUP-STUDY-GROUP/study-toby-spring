# 1ì¥ ì˜¤ë¸Œì íŠ¸ì™€ ì˜ì¡´ê´€ê³„

> ìŠ¤í”„ë§ì€ ìë°”ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ ê¸°ìˆ ì´ë‹¤. ìŠ¤í”„ë§ì´ ìë°”ì—ì„œ ê°€ì¥ ì¤‘ìš”í•˜ê²Œ ê°€ì¹˜ë¥¼ ë‘ëŠ” ê²ƒì€ ë°”ë¡œ  
> ê°ì²´ì§€í–¥ í”„ë¡œê·¸ë˜ë°ì´ ê°€ëŠ¥í•œ ì–¸ì–´ë¼ëŠ” ì ì´ë‹¤. 1ì¥ì—ì„œëŠ” ìŠ¤í”„ë§ì´ ì–´ë–¤ ê²ƒì´ê³ , ë¬´ì—‡ì„ ì œê³µí•˜ëŠ”ì§€ë³´ë‹¤ëŠ”  
> ìŠ¤í”„ë§ì´ ê´€ì‹¬ì„ ê°–ëŠ” ëŒ€ìƒì¸ ì˜¤ë¸Œì íŠ¸ì˜ "ì„¤ê³„"ì™€ "êµ¬í˜„", "ë™ì‘ ì›ë¦¬"ì— ë” ì§‘ì¤‘í•˜ê¸¸ ë°”ë€ë‹¤.

## 1.1 ì´ˆë‚œê° DAO

> **DAO**  
> DAO(Data Access Object)ëŠ” **DBë¥¼ ì‚¬ìš©**í•´ **ë°ì´í„°**ë¥¼ **ì¡°íšŒ**í•˜ê±°ë‚˜ **ì¡°ì‘**í•˜ëŠ” ê¸°ëŠ¥ì„ ì „ë‹´í•˜ëŠ” **ì˜¤ë¸Œì íŠ¸**ë¥¼ ë§í•œë‹¤

- ì‚¬ìš©ì ì •ë³´ë¥¼ JDBC APIë¥¼ í†µí•´ DBì— ì €ì¥í•˜ê³  ì¡°íšŒí•  ìˆ˜ ìˆëŠ” ê°„ë‹¨ DAO í•˜ë‚˜ë¥¼ ë§Œë“¤ì–´ë³¸ë‹¤

### 1.1.1 User

> **ìë°”ë¹ˆ**  
> ìë°”ë¹ˆì€ ë‹¤ìŒ ë‘ ê°€ì§€ ê´€ë¡€ë¥¼ ë”°ë¼ ë§Œë“¤ì–´ì§„ ì˜¤ë¸Œì íŠ¸ë¥¼ ì§€ì¹­í•¨  
> - ë””í´íŠ¸ ìƒì„±ì : ìë°”ë¹ˆì€ íŒŒë¼ë¯¸í„°ê°€ ì—†ëŠ” ë””í´íŠ¸ ìƒì„±ìë¥¼ ê°€ì§€ê³  ìˆì–´ì•¼ í•¨, íˆ´ì´ë‚˜ F/Wì—ì„œ **ë¦¬í”Œë™ì…˜**ì„ í†µí•´ Objectë¥¼ ìƒì„±í•˜ê¸° ë•Œë¬¸ì´ë‹¤  
> - í”„ë¡œí¼í‹° : ìë°”ë¹ˆì´ ë…¸ì¶œí•˜ëŠ” ì´ë¦„ì„ ê°€ì§„ ì†ì„±ì„ ì˜ë¯¸í•˜ë©°, set í˜¹ì€ getìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ë©”ì„œë“œë¥¼ ì´ìš©í•´ ìˆ˜ì • ë˜ëŠ” ì¡°íšŒ ê°€ëŠ¥

- ì‚¬ìš©ì ì •ë³´ë¥¼ ì €ì¥í•  ë•ŒëŠ” ìë°”ë¹ˆ ê·œì•½ì„ ë”°ë¥´ëŠ” ì˜¤ë¸Œì íŠ¸ë¥¼ ì´ìš©í•˜ë©´ í¸ë¦¬í•˜ë‹¤
- User ê°ì²´ë¥¼ ë§Œë“¤ê³  id, name, password ì„¸ ê°œì˜ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ë¥¼ ê°–ëŠ” í´ë˜ìŠ¤ë¥¼ ìƒì„±í•œë‹¤

```java
public class User {
    String id; // seq
    String name; // ì´ë¦„
    String password; // ë¹„ë°€ë²ˆí˜¸

    public String getId() { 
        return id;
    }
    public void setId(String id) {
        this.id = id;
    }
    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
    public String getPassword() {
        return password;
    }
    public void setPassword(String password) {
        this.password = password;
    }
}
```

- ì´ì œ User ì˜¤ë¸Œì íŠ¸ê°€ ë‹´ê¸´ ì •ë³´ê°€ ì‹¤ì œ ë³´ê´€ë  DB í…Œì´ë¸” í•˜ë‚˜ë¥¼ ë§Œë“ ë‹¤
- í…Œì´ë¸” ì´ë¦„ì€ USERë¡œ í”„ë¡œí¼í‹°ëŠ” User í´ë˜ìŠ¤ì˜ í”„ë¡œí¼í‹°ì™€ ë™ì¼

| í•„ë“œëª… | íƒ€ì… | ì„¤ì • |
|------|------|------|
| UserId | VARCHAR(10) | Primary Key |
| Name | VARCHAR(20) | Not Null |
| Password | VARCHAR(20) | Not Null |

- MySQL ì‚¬ìš© ì‹œ ë‹¤ìŒê³¼ ê°™ì€ CREATE êµ¬ë¬¸ ì…ë ¥

```sql
create table users(
    id varchar(10) primary key,
    name varchar(20) not not null,
    password varchar(10) not null
)
```

### 1.1.2 UserDao

- ì‚¬ìš©ì ì •ë³´ë¥¼ DBì— ë„£ê³  ê´€ë¦¬í•˜ê¸° ìœ„í•´ DAO í´ë˜ìŠ¤ ìƒì„±í•œë‹¤ ( UserDAO )
- ê¸°ë³¸ì ì¸ CRUD ê¸°ëŠ¥ì´ í•„ìš”í•˜ì§€ë§Œ, ì¼ë‹¨ ìƒˆë¡œìš´ ì‚¬ìš©ìë¥¼ ìƒì„±í•˜ê³ (add), ì‚¬ìš©ì ì •ë³´ë¥¼ ì½ì–´ì˜¤ëŠ”(get) ê¸°ëŠ¥ ë¨¼ì € ë§Œë“ ë‹¤
- JDBCë¥¼ ì´ìš©í•˜ëŠ” ì‘ì—… ìˆœì„œëŠ” ì•„ë˜ì™€ ê°™ë‹¤
  - DB ì—°ê²°ì„ ìœ„í•œ Connectionì„ ê°€ì ¸ì˜´
  - SQLì— ë‹´ì„ Statement(or PreparedStagement)ë¥¼ ë§Œë“ ë‹¤
  - ë§Œë“¤ì–´ì§„ Statement ì‹¤í–‰
  - ì¡°íšŒì˜ ê²½ìš° SQL ì¿¼ë¦¬ ì‹¤í–‰ ê²°ê³¼ë¥¼ ResultSetìœ¼ë¡œ ë°›ì•„ Objì— ì˜®ê²¨ì¤€ë‹¤
  - ì‘ì—… ì¤‘ ìƒì„±ëœ ë¦¬ì†ŒìŠ¤ëŠ” ë°˜ë“œì‹œ ë‹«ëŠ”ë‹¤
  - JDBC APIê°€ ë§Œë“œëŠ” ì˜ˆì™¸ëŠ” ì¡ì•„ì„œ ì§ì ‘ ì²˜ë¦¬, throwsë¥¼ ì„ ì–¸í•˜ì—¬ ì²˜ë¦¬í•œë‹¤ 

```java
public class UserDao {

    // ìœ ì €ë¥¼ ì¶”ê°€í•˜ëŠ” í•¨ìˆ˜
    public void add(User user) throws ClassNotFoundException, SQLException { 
        Class.forName("com.mysql.jdbc.Driver")ï¼›
        Connection c = DriverManager.getConnection("jdbc:mysql://localhost/springbook", "spring", "book")ï¼›

        PreparedStatement ps = c.prepareStatement("insert into users(id, name, password) values(?, ?, ?)")ï¼›
        ps.setString(1, user.getld());
        ps.setString(2, user.getName())ï¼›
        ps.setString(3, user.getPassword())ï¼›

        ps.executeUpdate()ï¼›

        ps.close()ï¼›
        c.close()ï¼›
    }

    // ID ê¸°ë°˜ ìœ ì €ë¥¼ ì¡°íšŒí•˜ëŠ” í•¨ìˆ˜
    public User get(String id) throws ClassNotFoundException, SQLException {
        Class.forName("com.mysql.jdbc.Driver")ï¼›
        Connection c = DriverManager.getConnection("jdbc:mysql://localhost/springbook", "spring", "book")ï¼›
        
        PreparedStatement ps = c.prepareStatement("select * from users where id = ?")ï¼›
        ps.setString(1, id)ï¼›

        Result Set rs = ps.executeQuery()ï¼› 
        rs.next()ï¼›
        User user = new  User()ï¼›
        user.setld(rs.getString("id"))ï¼›
        user.setName(rs.getString("name"))ï¼›
        user.setPassword(rs.getString("password"))ï¼›
        
        rs.close()ï¼›
        ps.close()ï¼›
        c.close()ï¼›
        return userï¼›
    }
}
```

- ìœ„ì—ì„œëŠ” ê°„ë‹¨í•˜ê²Œ add, get í•˜ëŠ” í•¨ìˆ˜ ìƒì„± í•´ë³´ì•˜ë‹¤
- í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ì„œ ë‹¤ìŒì—ëŠ” DAO í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„± í•´ë³´ì

### 1.1.3 main()ì„ ì´ìš”í•œ DAO í…ŒìŠ¤íŠ¸ ì½”ë“œ

- ë§Œë“¤ì–´ì§„ ì½”ë“œì˜ ê¸°ëŠ¥ì„ ê²€ì¦í•˜ê³ ì í•  ë•ŒëŠ” `ì˜¤ë¸Œì íŠ¸ ìŠ¤ìŠ¤ë¡œ ìì‹ ì„ ê²€ì¦í•˜ê²Œ ë§Œë“¤ë©´ ëœë‹¤`
- ëª¨ë“  í´ë˜ìŠ¤ì—ëŠ” ìì‹ ì„ ì—”íŠ¸ë¦¬ í¬ì¸íŠ¸ë¡œ ì„¤ì •í•´ ì§ì ‘ ì‹¤í–‰ì´ ê°€ëŠ¥í•˜ê²Œ í•´ì£¼ëŠ” `static main`ì´ ì¡´ì¬í•œë‹¤

```java
public static void main(String[] args) throws ClassNotFoundException, SQLException {
    UserDao dao = new UserDao();
    
    User user = new User();
    user.setId("whiteship");
    user.setName("ë°±ê¸°ì„ ");
    user.setPassword("married");

    dao.add(user); // userDaoì— User ê°ì²´ë¥¼ ë„£ê³  add(INSERT) ë¥¼ í†µí•´ DBì— ë°ì´í„° ì €ì¥
    System.out.println(user.getId() + "ë“±ë¡ ì„±ê³µ");

    User user2 = dao.get(user.getId); // íšŒì› ì¡°íšŒ
    System.out.println(user2);
    System.out.printin(user2.getPassword())ï¼› 

    System.out.println(user2.getld() + "ì¡°íšŒ ì„±ê³µ");
}
```

- ìœ„ í´ë˜ìŠ¤ë¥¼ ì‹¤í–‰í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆìŒ

```java
whiteship ë“±ë¡ ì„±ê³µ 
ë°±ê¸°ì„ 
married
whiteship ì¡°íšŒ ì„±ê³µ
```

- â“ `í•˜ì§€ë§Œ ì§€ê¸ˆ ë§Œë“  UserDao í´ë˜ìŠ¤ ì½”ë“œì—ëŠ” ì—¬ëŸ¬ê°€ì§€ ë¬¸ì œê°€ ì¡´ì¬í•œë‹¤`
- âœ… `ë‹¤ìŒì—ëŠ” DAOì˜ ë¶„ë¦¬ë¥¼ í†µí•´ ìŠ¤í”„ë§ F/Wì— ë§ê²Œ ì†ŒìŠ¤ë¥¼ ìˆ˜ì • í•´ë³´ì`

## 1.2 DAOì˜ ë¶„ë¦¬

### 1.2.1 ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬

- ì„¸ìƒì—ëŠ” ë³€í•˜ëŠ” ê²ƒê³¼ ë³€í•˜ì§€ ì•ŠëŠ” ê²ƒì´ ìˆë‹¤. í•˜ì§€ë§Œ ê°ì²´ì§€í–¥ ì„¸ê³„ì˜ ëª¨ë“ ê²ƒì€ ë³€í•œë‹¤
- ì—¬ê¸°ì„œ ë³€í•œë‹¤ëŠ” ê²ƒì€ ë³€ìˆ˜, Obj í•„ë“œê°’ì´ ë³€í•˜ëŠ”ê²ƒì´ ì•„ë‹ˆë‹¤
  - `ì˜¤ë¸Œì íŠ¸ì— ëŒ€í•œ ì„¤ê³„ì™€, ì´ë¥¼ êµ¬í˜„í•œ ì½”ë“œê°€ ë³€í•œë‹¤ëŠ” ëœ»`
- `ê°œë°œìê°€ ê°ì²´ë¥¼ ì„¤ê³„í•  ë•Œ ê°€ì¥ ì—¼ë‘í•´ì•¼ í•˜ëŠ” ë¶€ë¶„ì€ ë¯¸ë˜ì˜ ë³€í™”ë¥¼ ì–´ë–»ê²Œ ëŒ€ë¹„í•  ê²ƒì¸ê°€ ì´ë‹¤`

> ë¶„ë¦¬ì— ëŒ€í•œ í•œ ê°€ì§€ ì˜ˆë¥¼ ë“¤ì–´ë³´ì, ê¸°ëŠ¥ ìš”êµ¬ ì‚¬í•­ì„ ì£¼ëŠ” ê²½ìš°ì— "DBë¥¼ Oracleì—ì„œ MySQLë¡œ ë°”ê¾¸ë©´ì„œ, ì›¹ í™”ë©´ì˜  
> ë ˆì´ì•„ì›ƒì„ ë‹¤ì¤‘ í”„ë ˆì„ êµ¬ì¡°ì—ì„œ ë‹¨ì¼ í”„ë ˆì„ì— Ajaxë¥¼ ì ìš©í•œ êµ¬ì¡°ë¡œ ë°”ê¾¸ê³ , ë§¤ì¶œì´ ì¼ì–´ë‚  ë•Œ ì§€ë‚œë‹¬  
> í‰ê·  ë§¤ì¶œì•¡ë³´ë‹¤ ë§ìœ¼ë©´ ê°ì‚¬ ì‹œìŠ¤í…œì˜ ì •ë³´ê°€ ì›¹ ì„œë¹„ìŠ¤ë¡œ ì „ì†¡ë˜ëŠ” ë™ì‹œì— ë¡œê·¸ëŠ” ë‚ ì§œ í¬ë§·ì„ 6ìë¦¬ì—ì„œ  
> Y2Kë¥¼ ê³ ë ¤í•´ 8ìë¦¬ë¡œ ë°”ê¿”ë¼"ëŠ” ì‹ìœ¼ë¡œ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤.  
>
> ë¬´ìŠ¨ ì• ê¸´ê°€ í•˜ë©´, ëª¨ë“  ë³€ê²½ê³¼ ë°œì „ì€ í•œ ë²ˆì— í•œ ê°€ì§€ ê´€ì‹¬ì‚¬í•˜ì— ì§‘ì¤‘í•˜ì—¬ ì¼ì–´ë‚œë‹¤ëŠ” ëœ»ì´ë‹¤.  
> ë¬¸ì œëŠ”, ë³€í™”ëŠ” ëŒ€ì²´ë¡œ í•œ ê°€ì§€ ê´€ì‹¬ì— ëŒ€í•´ ì¼ì–´ë‚˜ì§€ë§Œ ê·¸ì— ë”°ë¥¸ ì‘ì—…ì€ í•œê³³ì— ì§‘ì¤‘ë˜ì§€ ì•ŠëŠ” ê²½ìš°ê°€   
> ë§ë‹¤ëŠ” ì ì´ë‹¤.  
>
> ex) DB ì ‘ì† ì•”í˜¸ ë³€ê²½ì„ ìœ„í•´ DAO í´ë˜ìŠ¤ ìˆ˜ë°±ê°œë¥¼ ìˆ˜ì •í•´ì•¼ í•˜ëŠ”ê²½ìš°?  
> ex) íŠ¸ëœì­ì…˜ ê¸°ìˆ ì„ ë³€ê²½ í•˜ì˜€ë‹¤ê³  ë¹„ì¦ˆ ë¡œì§ì´ ë‹´ê¸´ ì½”ë“œì˜ êµ¬ì¡°ë¥¼ ëª¨ë‘ ë³€ê²½í•´ì•¼ í•˜ëŠ” ê²½ìš°?  
>  
> ğŸ˜¶ ì—¬ê¸°ì„œ ë§í•˜ëŠ” ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬ë¼ëŠ” ê±´ ê´€ì‹¬ì‚¬ê°€ ê°™ì€ ê²ƒì€ ê°™ì€ ê²ƒë¼ë¦¬ ëª¨ìœ¼ê³  ë‹¤ë¥¸ ê²ƒì€  
> ë¶„ë¦¬ í•´ì¤Œìœ¼ë¡œì¨ ê°™ì€ ê´€ì‹¬ì— íš¨ê³¼ì ìœ¼ë¡œ ì§‘ì¤‘í•  ìˆ˜ ìˆê²Œ ë§Œë“œëŠ” ê²ƒ

### 1.2.2 ì»¤ë„¥ì…˜ ë§Œë“¤ê¸°ì˜ ì¶”ì¶œ

```java
// ìœ ì €ë¥¼ ì¶”ê°€í•˜ëŠ” í•¨ìˆ˜
public void add(User user) throws ClassNotFoundException, SQLException { 
    Class.forName("com.mysql.jdbc.Driver")ï¼›
    Connection c = DriverManager.getConnection("jdbc:mysql://localhost/springbook", "spring", "book")ï¼›

    PreparedStatement ps = c.prepareStatement("insert into users(id, name, password) values(?, ?, ?)")ï¼›
    ps.setString(1, user.getld());
    ps.setString(2, user.getName())ï¼›
    ps.setString(3, user.getPassword())ï¼›

    ps.executeUpdate()ï¼›

    ps.close()ï¼›
    c.close()ï¼›
}

// ğŸ¤£ ì•„ë˜ì™€ ê°™ì€ ë©”ì„œë“œê°€ 1000ê°œë¼ë©´?? DB ë³€ê²½ ì‘ì—… ìˆì„ ê²½ìš° ëª¨ë“  í•¨ìˆ˜ ìˆ˜ì •í•´ì£¼ì–´ì•¼ í•¨
// public void update() {
//     Class.forName("com.mysql.jdbc.Driver");
//     Connection c = DriverManager.getConnection("jdbc:mysql://localhost/springbook", "spring", "book");
//     ...
// }

// public void delete() {
//     Class.forName("com.mysql.jdbc.Driver");
//     Connection c = DriverManager.getConnection("jdbc:mysql://localhost/springbook", "spring", "book");
//     ...
// }

// public void changeMemberFlag() {
//     Class.forName("com.mysql.jdbc.Driver");
//     Connection c = DriverManager.getConnection("jdbc:mysql://localhost/springbook", "spring", "book");
//     ...
// }
```

- UserDaoì˜ add ë©”ì„œë“œë¥¼ ë³´ë©´ ë©”ì„œë“œ í•˜ë‚˜ì—ë§Œ ì ì–´ë„ `ì„¸ ê°€ì§€ ê´€ì‹¬ì‚¬í•­`ì´ ì¡´ì¬
  - 01) DB ì—°ê²°ì— ëŒ€í•œ ê´€ì‹¬ì‚¬
  - 02) SQL ì‘ì„±ì— ëŒ€í•œ ê´€ì‹¬ì‚¬
  - 03) ë¦¬ì†ŒìŠ¤ ë°˜í™˜ì— ëŒ€í•œ ê´€ì‹¬ì‚¬

### ì¤‘ë³µ ì½”ë“œì˜ ë©”ì„œë“œ ì¶”ì¶œ

- ê´€ì‹¬ì‚¬ ë¶„ë¦¬ë¥¼ ìœ„í•´ ê°€ì¥ ë¨¼ì € í• ì¼ì€ `DB ì»¤ë„¥ì…˜ì„ ê°€ì ¸ì˜¤ëŠ” ì¤‘ë³µ ì½”ë“œë¥¼ ë¶„ë¦¬í•˜ëŠ” ê²ƒ`
- ì¤‘ë³µëœ DB ì—°ê²° ì½”ë“œ -> getConnection() ë©”ì„œë“œë¡œ ë¶„ë¦¬

```java
// TO-BE: refacotor

public void add(User user) throws ClassNotFoundException, SQLException {
    Connection c = getConnection(); // DB ì»¤ë„¥ì…˜ ê´€ë ¨ ê°ì²´ íšë“
    ...
}

public User get(String id) throws ClassNotFoundException, SQLException {
    Connection c = getConnection(); // DB ì»¤ë„¥ì…˜ ê´€ë ¨ ê°ì²´ íšë“
    ...
}

public Connection getConnection() throws ClassNotFoundException, SQLExpception {
    Class.forName("com.mysql.jdbc.Driver");
    Connection c = DriverManager.getConnection("jdbc:mysql://localhost/springboot", "spring", "book");
}
```

- ì´ë ‡ê²Œ ë˜ë©´ ì—¬ëŸ¬ê°œì˜ í•¨ìˆ˜ ìˆ˜ì • ì—†ì´ 1ê°œì˜ í•¨ìˆ˜(getConnection())ë§Œ ìˆ˜ì •í•˜ë©´ ë¨
- `ê´€ì‹¬ì‚¬ë¥¼ ë¶„ë¦¬í•˜ê³ , SRP(Single Responsbility Principle) ì›ì¹™ì— ë§ì¶° ì‘ì„±`

### 1.2.3 DB ì»¤ë„¥ì…˜ ë§Œë“¤ê¸°ì˜ ë…ë¦½

- UserDaoê°€ ë°œì „í•˜ì—¬ ì¸ê¸°ë¥¼ ëŒë”ë‹ˆ Nì‚¬ì™€ Dì‚¬ì—ì„œ ì‚¬ìš©ì ê´€ë¦¬ë¥¼ ìœ„í•´ UserDaoë¥¼ êµ¬ë§¤
- ë¬¸ì œ 01) ë‚©í’ˆ ê³¼ì •ì—ì„œ Nì‚¬ì™€ Dì‚¬ëŠ” ê°ê¸° ë‹¤ë¥¸ ì¢…ë¥˜ì˜ DBë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŒ
- ë¬¸ì œ 02) ì¶”í›„ì—ë„ DBê°€ ë°”ë€” ìˆ˜ ìˆë‹¤ê³  í•¨

### ìƒì†ì„ í†µí•œ í™•ì¥

- ìœ„ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ë°©ë²•ì€ UserDao ì½”ë“œë¥¼ í•œ ë‹¨ê³„ ë” ë¶„ë¦¬í•˜ë©´ ëœë‹¤
- `UserDaoëŠ” ì¶”ìƒë©”ì„œë“œ ì œê³µ Nì‚¬ Dì‚¬ëŠ” UserDaoë¥¼ ìƒì†í•˜ì—¬ ê¸°ëŠ¥ì„ ì™„ì„± í•œë‹¤`
- ê·¸ë¦¼ 1-1ì„ ì°¸ê³ í•˜ì

![1-1_ìƒì†ì„í†µí•œ_userdao_í™•ì¥.png](./img/01.png)

- ë¦¬íŒ©í„°ë§ ì†ŒìŠ¤ëŠ” ì•„ë˜ì™€ ê°™ë‹¤

```java
public abstract class UserDao {

    public void add(User user) throws ClassNotFoundException, SQLException {
        Connection c = getConnection();
        ...
    }

    public User get(String id) throws ClassNotFoundException, SQLException {
        Connection c = getConnection();
        ...
    }

    // DB Connection ë¶€ë¶„ì„ ì¶”ìƒ ë©”ì„œë“œë¡œ ì‘ì„±
    public abstract Connection getConnection() throws ClassNotFoundException, SQLException;
}
```

```java
public class NUserDao extends UserDao {

    public Connection getConnection() throws ClassNotFoundException, SQLException {
        // Nì‚¬ DB Connection ìƒì„± ì½”ë“œ
    }
}

public class DUserDao extends UserDao {
    public Connection getConnection() throws ClassNotFoundException, SQLException {
        // Dì‚¬ DB Connection ìƒì„± ì½”ë“œ
    }
}
```

- ì¶”ìƒ í´ë˜ìŠ¤ëŠ” ê°ì²´ ìƒì„±ì´ ë¶ˆê°€ëŠ¥í•˜ê³  í•˜ìœ„ í´ë˜ìŠ¤ëŠ” ì´ëŸ¬í•œ ì¶”ìƒ í´ë˜ìŠ¤ë¥¼ ìƒì†í•˜ì—¬ ê¸°ëŠ¥ì„ ì´ìš©(add, get í•¨ìˆ˜)í•˜ê³  í™•ì¥(getConnection í•¨ìˆ˜)í•˜ëŠ” ëª©ì ì„ ê°€ì§€ê³  ìˆë‹¤. ì´ì— ë°˜í•´ì„œ ì¸í„°í˜ì´ìŠ¤ëŠ” ê¸°ëŠ¥ì˜ í™•ì¥ë³´ë‹¤ëŠ” í•˜ìœ„ í´ë˜ìŠ¤ê°€ ìƒìœ„ êµ¬í˜„ í´ë˜ìŠ¤ì™€ ë™ì¼í•œ í–‰ìœ„ë¥¼ ìˆ˜í–‰í•˜ë„ë¡ ë³´ì¥ì„ í•˜ê¸° ìœ„í•´ ì‚¬ìš©ì´ ë¨
- ìœ„ì™€ ê°™ì´ `ìŠˆí¼í´ë˜ìŠ¤(UserDao)ì—ëŠ” ê¸°ë³¸ì ì¸ ë¡œì§ì˜ íë¦„`(`ì»¤ë„¥ì…˜ ê°€ì ¸ì˜¤ê¸°, SQL ìƒì„±, ì‹¤í–‰, ë°˜í™˜`)`ì„ ë§Œë“¤ê³ `, `ê·¸ ê¸°ëŠ¥ì˜ ì¼ë¶€ë¥¼ ì¶”ìƒ ë©”ì„œë“œë‚˜ ì˜¤ë²„ë¼ì´ë”©ì´ ê°€ëŠ¥í•œ protected ë©”ì„œë“œ ë“±ìœ¼ë¡œ ë§Œë“  ë’¤ ì„œë¸Œ í´ë˜ìŠ¤ì—ì„œ ì´ëŸ° ë©”ì„œë“œë¥¼ í•„ìš”ì— ë§ê²Œ êµ¬í˜„`í•´ì„œ ì‚¬ìš©í•˜ë„ë¡ í•˜ëŠ” ë°©ë²•ì„ ë””ìì¸ íŒ¨í„´ì—ì„œëŠ” **`í…œí”Œë¦¿ ë©”ì„œë“œ íŒ¨í„´`** ì´ë¼ í•œë‹¤
- UserDaoì˜ getConnection() ë©”ì„œë“œëŠ” `Connection íƒ€ì… ì˜¤ë¸Œì íŠ¸ë¥¼ ìƒì„± ë° ë°˜í™˜`í•œë‹¤ëŠ” ê¸°ëŠ¥ì„ ì •ì˜í•´ë‘” `ì¶”ìƒ ë©”ì„œë“œ`ì´ë‹¤. ê·¸ë¦¬ê³  UserDaoì˜ ì„œë¸Œ í´ë˜ìŠ¤ì˜ getConnection() ë©”ì„œë“œëŠ” `ì–´ë–¤ Connection í´ë˜ìŠ¤ ì˜¤ë¸Œì íŠ¸ë¥¼ ì–´ë–»ê²Œ ìƒìƒ`í•  ê²ƒì¸ì§€ ê²°ì •í•˜ëŠ” ë°©ë²•ì´ë¼ ë³¼ ìˆ˜ ìˆìŒ, ì´ë ‡ê²Œ `ì„œë¸Œ í´ë˜ìŠ¤ì—ì„œ êµ¬ì²´ì ì¸ ì˜¤ë¸Œì íŠ¸ ìƒì„± ë°©ë²•ì„ ê²°ì •`í•˜ê²Œ í•˜ëŠ” ê²ƒì„ **`íŒ©í† ë¦¬ ë©”ì„œë“œ íŒ¨í„´`** ì´ë¼ê³  ë¶€ë¥¸ë‹¤

// Q. í…œí”Œë¦¿ ë©”ì„œë“œ íŒ¨í„´ vs íŒ©í† ë¦¬ ë©”ì„œë“œ íŒ¨í„´ì˜ ì°¨ì´ëŠ”? 

### ë””ìì¸ íŒ¨í„´

- ì†Œí”„íŠ¸ì›¨ì–´ ì„¤ê³„ ì‹œ íŠ¹ì • ìƒí™©ì—ì„œ ìì£¼ ë§Œë‚˜ëŠ” ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì†”ë£¨ì…˜

### í…œí”Œë¦¿ ë©”ì„œë“œ íŒ¨í„´

```java
public abstract class Super {
    public void templateMethod() {
        // ê¸°ë³¸ ì•Œê³ ë¦¬ì¦˜ ì½”ë“œ
        hookMethod();
        abstractMethod();
        ...
    }

    protected void hookMethod() {  } // ì„ íƒì  ì˜¤ë²„ë¼ì´ë“œ ê°€ëŠ¥ í›… ë©”ì„œë“œ
    public abstract void abstractMethod(); // ì„œë¸Œ í´ë˜ìŠ¤ì—ì„œ ë°˜ë“œì‹œ êµ¬í˜„í•´ì•¼ í•˜ëŠ” ì¶”ìƒë©”ì„œë“œ
}

public class Sub1 extends Super {
    protected void hookMethod() {
        ...
    }

    public void abstractMethod() {
        ...
    }
}
```

- `ìƒì†`ì„ í†µí•´ `ìŠˆí¼í´ë˜ìŠ¤`ì˜ `ê¸°ëŠ¥ í™•ì¥` ì‹œ ì£¼ë¡œ ì‚¬ìš©
- `ë³€í•˜ì§€ ì•Šì„ ê¸°ëŠ¥`ì€ `ìŠˆí¼í´ë˜ìŠ¤`ì— `ìì£¼ ë³€ê²½ë˜ë©° í™•ì¥ í•„ìš” ê¸°ëŠ¥`ì€ `ì„œë¸Œ í´ë˜ìŠ¤`ì— ì‘ì„±
- ìŠˆí¼í´ë˜ìŠ¤ì—ì„œ `ë””í´íŠ¸ ê¸°ëŠ¥`ì„ ì •ì˜í•´ë‘ê±°ë‚˜ ë¹„ì›Œë’€ë‹¤ê°€ ì„œë¸Œí´ë˜ìŠ¤ì—ì„œ ì„ íƒì  ì˜¤ë²„ë¼ì´ë”©ì´ì´ ê°€ëŠ¥í•˜ê²Œ ë§Œë“  ë©”ì„œë“œë¥¼ `í›…`(`hook`) ë©”ì„œë“œë¼ í•œë‹¤
- ì„œë¸Œí´ë˜ìŠ¤ì—ì„œëŠ” ì¶”ìƒ ë©”ì„œë“œë¥¼ êµ¬í˜„í•˜ê±°ë‚˜, í›… ë©”ì„œë“œë¥¼ ì˜¤ë²„ë¼ì´ë”©í•˜ì—¬ ê¸°ëŠ¥ í™•ì¥ì„ ìˆ˜í–‰


### íŒ©í† ë¦¬ ë©”ì„œë“œ íŒ¨í„´

> ğŸ˜’ íŒ©í† ë¦¬ ë©”ì„œë“œì™€ íŒ©í† ë¦¬ ë©”ì„œë“œ íŒ¨í„´ì€ ì—„ì—°íˆ ë‹¤ë¥¸ ê°œë…  
> íŒ©í† ë¦¬ íŒ¨í„´ì€ ê°ì²´ ìƒì„±ê³¼ ê´€ë ¨ëœ ë””ìì¸ íŒ¨í„´ì´ë‹¤

- í…œí”Œë¦¿ ë©”ì„œë“œ íŒ¨í„´ê³¼ ë™ì¼í•˜ê²Œ `ìƒì†ì„ í†µí•´ ê¸°ëŠ¥ì„ í™•ì¥`í• ë•Œ ì‚¬ìš©í•˜ëŠ” ë°©ë²•
- T. ì¶”ê°€ ì •ë¦¬ í•„ìš”

## 1.3 DAOì˜ í™•ì¥

### 1.3.1 í´ë˜ìŠ¤ì˜ ë¶„ë¦¬

- ì´ë²ˆì—ëŠ” ê´€ì‹¬ì‚¬ê°€ ë‹¤ë¥´ê³  ë³€í™”ì˜ ì„±ê²©ì´ ë‹¤ë¥¸ ì´ ë‘ ê°€ì§€ ì½”ë“œë¥¼ ë¶„ë¦¬ í•  ê²ƒ ì´ë‹¤
- ë‘ ê°œì˜ ê´€ì‹¬ì‚¬ë¥¼ ë…ë¦½ì‹œí‚¤ê³  ì†ì‰½ê²Œ í™•ì¥ í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì— ëŒ€í•´ ì•Œì•„ë³¸ë‹¤
- ì§€ê¸ˆê¹Œì§€ ìˆ˜í–‰í•œ ì‘ì—…ì€ ë‹¤ìŒê³¼ ê°™ë‹¤
  - 1) ë…ë¦½ëœ ë©”ì„œë“œ(getConnection())ì„ ë§Œë“¤ì–´ì„œ ë¶„ë¦¬
  - 2) ìƒ(UserDao)/í•˜ìœ„ í´ë˜ìŠ¤(NUserDao, DUserDao)ë¡œ ë¶„ë¦¬
  - 3) ì´ë²ˆì—ëŠ” ìƒì†ê´€ê³„ ì•„ë‹Œ ì™„ì „ ë…ë¦½ì  í´ë˜ìŠ¤ë¡œ ë§Œë“¤ì–´ë³´ì
  - 4) `DB ê´€ë ¨ ë¡œì§ ì„œë¸Œ í´ë˜ìŠ¤ê°€ ì•„ë‹Œ ë³„ë„ì˜ í´ë˜ìŠ¤ì— ë‹´ì•„ë‘”ë‹¤`
  - 4-1) `ì´ë ‡ê²Œ ë§Œë“  í´ë˜ìŠ¤ë¥¼ UserDaoê°€ ì´ìš©í•˜ë©´ ë` 

![1-3 ë‘ ê°œì˜ ë…ë¦½ëœ í´ë˜ìŠ¤ë¡œ ë¶„ë¦¬í•œ ê²°ê³¼](./img/02.png)

- ê·¸ë¦¼ 1-3 ì²˜ëŸ¼ SimpleConnectionMaker í´ë˜ìŠ¤ ìƒì„± í›„ DB ìƒì„± ê¸°ëŠ¥ì„ ì¶”ê°€í•œë‹¤
- SimpleConnectionMakerì˜ ì˜¤ë¸Œì í‹‘ ìƒì„± í›„ add/get ë©”ì„œë“œ ì´ìš© DB ì»¤ë„¥ì…˜ì„ ê°€ì ¸ì˜¨ë‹¤

```java
public class UserDao {
    private SimpleConnectionMaker simpleConnectionMaker;

    public UserDao() {
        simpleConnectionMaker = new SimpleConnectionMaker();
    }
    
    public void add(User user) throws ClassNotFoundException, SQLException {
        Connection c = simpleConnectionMaker.makeNewConnection();
        ...
    }

    public User get(String id) throws ClassNotFoundException, SQLException {
        Connection c = simpleConnectionMaker.makeNewConnection();
        ...
    }

    // public Connection getConnection() throws ClassNotFoundException, SQLExpception {
    //     Class.forName("com.mysql.jdbc.Driver");
    //     Connection c = DriverManager.getConnection("jdbc:mysql://localhost/springboot", "spring", "book");
    // }
}
```

```java
public class SimpleConnectionMaker {
    public Connection getConnection() throws ClassNotFoundException, SQLException {
        Class.forName("com.mysql.jdbc.Driver");
        Connection c = DriverManager.getConnection("jdbc:mysql://localhost/springboot", "spring", "book");
        return c;
    }
}
```

- **ë¬¸ì œ 01**) N ì‚¬ì™€ D ì‚¬ì— UserDao í´ë˜ìŠ¤ë§Œ ê³µê¸‰í•˜ê³  ìƒì†ì„ í†µí•´ DB ì»¤ë„¥ì…˜ ê¸°ëŠ¥ í™•ì¥ì´ ì´ì œ ë¶ˆê°€ëŠ¥
  - UserDaoì˜ ì½”ë“œê°€ SimpleConnectionMaker í´ë˜ìŠ¤ì— ì¢…ì†ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— ìƒì†ì„ ì‚¬ìš©í–ˆì„ë•Œì²˜ëŸ¼
  UserDao ì½”ë“œ ìˆ˜ì • ì—†ì´ DB ì»¤ë„¥ì…˜ ìƒì„± ê¸°ëŠ¥ ë³€ê²½ ë°©ë²•ì´ ì—†ìŒ
  - // Q. ì´ ë§ì¸ ì¦‰ìŠ¨, ì˜¤ë²„ë¼ì´ë”©ì„ í†µí•´ ì†ŒìŠ¤ ì¬ì •ì˜ê°€ ë¶ˆê°€ëŠ¥í•˜ë‹¤ëŠ” ì˜ë¯¸?
- **ë¬¸ì œ 02**) ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ DB ì»¤ë„¥ì…˜ ì œê³µ í´ë˜ìŠ¤ ì‚¬ìš©ì„ ìœ„í•´ì„œëŠ” UserDaoì˜ ë‹¤ìŒ ì†ŒìŠ¤ ìˆ˜ì • í•„ìš”

```java
simpleConnectionMaker = new SimpleConnectionMaker(); // ìƒì„±ì í˜¸ì¶œ ì‹œì ì— í•´ë‹¹ ê°ì²´ë¥¼ ì£¼ì… ë°›ì•„ì„œ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ì— ë„£ì–´ë‘”ë‹¤
```


### 1.3.2 ì¸í„°í˜ì´ìŠ¤ì˜ ë„ì…

> ì¸í„°í˜ì´ìŠ¤ëŠ” ìì‹ ì„ êµ¬í˜„í•œ êµ¬í˜„ í´ë˜ìŠ¤ì˜ ì •ë³´ë¥¼ ëª¨ë‘ ê°ì¶°ë²„ë¦°ë‹¤

- í´ë˜ìŠ¤ë¥¼ ë¶„ë¦¬í•˜ë©´ì„œë„ ìœ„ ê°™ì€ ë¬¸ì œë¥¼ í•´ê²°í•˜ë ¤ë©´?
  - ì¸í„°í˜ì´ìŠ¤ ë„ì…

```java
public interface ConnectionMaker {

    public Connection makeConnection() throws ClassNotFoundException, SQLException;

}
```

- ê³ ê°ì—ê²Œ ë‚©í’ˆì‹œ UserDaoì™€ ConnectionMaker ì¸í„°í˜ì´ìŠ¤ë„ ì „ë‹¬
- Dì‚¬ì˜ ê°œë°œìë¼ë©´ ë‹¤ìŒê³¼ ê°™ì´ Ië¥¼ êµ¬í˜„í•œ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ê²ƒì´ë‹¤

```java
public class DConnectionMaker implements ConnectionMaker {
    ...
    public Connection makeConnection() throws ClassNotFoundException, SQLException {
        // Dì‚¬ì˜ ë…ìì ì¸ ë°©ë²• ì‚¬ìš©
    }
}
```

- ë‹¤ìŒìœ¼ë¡œëŠ” UserDao ì†ŒìŠ¤ ìˆ˜ì •

```java
public class UserDao {
    private ConnectionMaker connectionMaker; // ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´ ì ‘ê·¼í•˜ê¸°ì— êµ¬ì²´ì ì¸ í´ë˜ìŠ¤ ì •ë³´ ëª°ë¼ë„ ë¨

    public UserDao() {
         // ì•—! ê·¸ëŸ°ë° ì—¬ê¸° í´ë˜ìŠ¤ ì´ë¦„ ë‚˜ì˜¤ë„¤? <-> ì§€ê¸ˆì€ Dì‚¬ ì „ìš©ì¸ë°?
         // ë§Œì•½ Nì‚¬ ì „ìš©ìœ¼ë¡œ ë§Œë“œë ¤ê³  í•œë‹¤ë©´? new NConnectionMaker()ë¥¼ ë°›ì•„ì„œ ì‚¬ìš©í•´ì•¼ í•  ê²ƒì´ë‹¤
        connectionMaker = new DConnectionMaker();
    }
    
    public void add(User user) throws ClassNotFoundException, SQLException {
        Connection c = connectionMaker.makeConnection();
        ...
    }

    public User get(String id) throws ClassNotFoundException, SQLException {
        Connection c = connectionMaker.connectionMaker();
        ...
    }
}
```

### 1.3.3 ê´€ê³„ì„¤ì • ì±…ì„ì˜ ë¶„ë¦¬

```java
public UserDao(ConncetionMaker connectionMaker) {
    this.connectionMaker = connectionMaker;
}
```

- A

```java
public class UserDaoTest {
    public static void main(String[] args) throws ClassNotFoundException, SQLException {
        ConnectionMaker connectionMaker = new DConnectionMaker();
        UserDao dao = new UserDao(connectionMaker);
    }
}
```

### 1.3.4 ì›ì¹™ê³¼ íŒ¨í„´

## 1.4 ì œì–´ì˜ ì—­ì „(IoC)

### 1.4.1 ì˜¤ë¸Œì íŠ¸ íŒ©í† ë¦¬

### 1.4.2 ì˜¤ë¸Œì íŠ¸ íŒ©í† ë¦¬ì˜ í™œìš©

### 1.4.3 ì œì–´ê¶Œì˜ ì´ì „ì„ í†µí•œ ì œì–´ê´€ê³„ ì—­ì „

## 1.5 ìŠ¤í”„ë§ì˜ IoC

### 1.5.1 ì˜¤ë¸Œì íŠ¸ íŒ©í† ë¦¬ë¥¼ ì´ìš©í•œ ìŠ¤í”„ë§ IoC

### 1.5.2 ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ì˜ ë™ì‘ ë°©ì‹

### 1.5.3 ìŠ¤í”„ë§ IoCì˜ ìš©ì–´ ì •ë¦¬

## 1.6 ì‹±ê¸€í†¤ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì™€ ì˜¤ë¸Œì íŠ¸ ìŠ¤ì½”í”„

### 1.6.1 ì‹±ê¸€í†¤ ë ˆì§€ìŠ¤íŠ¸ë¦¬ë¡œì„œì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸

### 1.6.2 ì‹±ê¸€í†¤ê³¼ ì˜¤ë¸Œì íŠ¸ì˜ ìƒíƒœ

### 1.6.3 ìŠ¤í”„ë§ ë¹ˆì˜ ìŠ¤ì½”í”„

## 1.7 ì˜ì¡´ê´€ê³„ ì£¼ì…(DI)

### 1.7.1 ì œì–´ì˜ ì—­ì „(IoC)ì™€ ì˜ì¡´ê´€ê³„ ì£¼ì…

### 1.7.2 ëŸ°íƒ€ì„ ì˜ì¡´ê´€ê³„ ì„¤ì •

### 1.7.3 ì˜ì¡´ê´€ê³„ ê²€ìƒ‰ê³¼ ì£¼ì…

### 1.7.4 ì˜ì¡´ê´€ê³„ ì£¼ì…ì˜ ì‘ìš©

### 1.7.5 ë©”ì†Œë“œë¥¼ ì´ìš©í•œ ì˜ì¡´ê´€ê³„ ì£¼ì…

## 1.8 XMLì„ ì´ìš©í•œ ì„¤ì •

### 1.8.1 XML ì„¤ì •

### 1.8.2 XMLì„ ì´ìš©í•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸

### 1.8.3 DataSource ì¸í„°í˜ì´ìŠ¤ë¡œ ë³€í™˜

### 1.8.4 í”„ë¡œí¼í‹° ê°’ì˜ ì£¼ì…

## 1.9 ì •ë¦¬